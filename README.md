# TARS 机器人 | 星际穿越

本项目灵感源自电影《星际穿越》中富有情感表达的智能机器人 TARS，旨在以低成本开源硬件为基础，构建一款具备自然语音交互、表情显示、动作反馈的桌面仿生机器人。它不仅是一项嵌入式与 AI 融合的综合实践项目，也是一个探索"人机共情"边界的作品。

📦 **项目目标**：构建一个结构紧凑、能量高效、反应灵敏，能够陪伴用户专注、对话和互动的具生命感的桌面搭子机器人。

## ✨ 项目主要特点
### 🔧 1. 嵌入式终端系统（ESP32-S3）

📍 部署于机器人主控板（ESP32-S3），运行固件，承担输入感知、显示反馈、网络通讯、执行指令等功能。

**主要功能：**
- OLED 屏幕显示（状态/表情）
- SG90 舵机控制
- 小智AI协议 / HTTP / WebSocket 通信
- 本地动作 & 按键响应
- 电池 + 升压供电

### 🏗️ 2. 机械结构系统（SolidWorks建模）

📍 机器人实体结构，封装全部电子部件，并支持机械运动。

**设计特点：**
- 壳体 + 舵机仓
- OLED窗口 / 开关位
- 电池舱 + 理线卡扣
- TARS风格外观设计

### 🧠 3. 后端对话服务（可选自建 Flask）

📍 为设备提供语言理解、语音合成、动作策略等 API 服务。

> **注意**：嵌入式一开始使用虾哥的小智AI服务器，后端同步开发此模块，方便后续接入。
**对话处理流程：**

```
[语音输入]
   │
   ▼
┌─────────────┐
│   STT 模块  │ ⬅───── 音频输入（上传或流式）
└─────────────┘
   │ Text
   ▼
┌─────────────┐
│   LLM 模块  │ ⬅───── 支持多个模型（OpenAI、Qwen、DeepSeek）
└─────────────┘
   │ Reply Text
   ▼
┌─────────────┐
│   TTS 模块  │ ⬅───── 自定义语音包模型支持（训练后部署）
└─────────────┘
   │ Audio URL
   ▼
[下发到设备]
     └─▶ WebSocket → display/motion/speak 命令

[设备 → 后端]
     └─▶ /device/event → 按键、动作完成、状态上报
```
## 📡 通信与数据流（设备 ↔ 后端 + 小智AI）
支持两种工作模式：
- ✅ 模式 A：连接小智AI（虾哥服务器） → 快速上线，立即体验
- ✅ 模式 B：连接自建 Flask 后端 → 可定制，支持自训练语音包、本地部署
### 🟢 模式 A：连接小智AI 云服务（默认启用）

```
[ESP32设备]
   └─▶ 连接 Wi-Fi
   └─▶ 向小智AI服务器发起握手（HTTP + WebSocket）
   └─▶ 发送录音（麦克风输入）
        │
        ▼
  小智AI服务器（虾哥）
   └─▶ 完成 STT → LLM → TTS
   └─▶ 返回文字 + 音频URL + 动作指令
   └─▶ ESP32 显示/播放/执行动作
```
### 🟡 模式 B：连接自建 Flask 后端（可联调/自定义模型）

```
[ESP32设备]
   └─▶ 连接 Wi-Fi
   └─▶ WebSocket /device/ws 连接到 Flask
   └─▶ 通过按钮或传感器触发"交互事件"
        │
        ▼
  Flask 后端服务
   ├─ /chat/turn（转发到 STT → LLM → TTS）
   ├─ 模型适配器层（可选 openai/qwen/edge-tts/自训练语音）
   ├─ /tts（生成自定义语音包音频）
   ├─ WebSocket 向设备推送 display / motion / speak
   └─ /device/event 接收事件上报（按钮/动作完成/心跳等）
```

## 🧱 项目架构图
```
┌────────────────────────────────────────────────────────────┐
│                    TARS Bot 系统架构                        │
└────────────────────────────────────────────────────────────┘

                ┌─────────────────────────────┐
                │       ESP32-S3 主控固件       │
                │─────────────────────────────│
                │ • OLED 屏幕显示（状态/表情） │
                │ • SG90 舵机控制               │
                │ • 小智AI协议 / HTTP / WS     │
                │ • 本地动作 & 按键响应         │
                │ • 电池 + 升压供电             │
                └─────────────────────────────┘
                            │
          ┌─────────────────┼─────────────────┐
          ▼                                     ▼
🟢 连接小智AI服务器                   🟡 自建 Flask 后端服务（Docker）
（默认接入体验）                     （自定义三段式 + 本地语音包）
          │                                     │
    ┌─────────────┐                     ┌────────────────────┐
    │ 小智AI 云服务 │                     │ Flask 后端框架（WS+REST）│
    │─────────────│                     │────────────────────│
    │ • 麦克风音频 → STT               │ • /chat/turn         │
    │ • LLM 语义理解                   │ • /tts（自定义 voice）│
    │ • 合成语音 TTS                  │ • /device/ws（推送）  │
    │ • 返回文字 + URL + 动作         │ • /device/event       │
    └─────────────┘                     └────────────────────┘
                                                 │
                    ┌────────────────────────────┼────────────────────────────┐
                    ▼                            ▼                            ▼
         🔌 模型适配层             📦 自训练语音包引擎             📄 Web 监控面板（可选）
        （支持任意 LLM / TTS）      （如 so-vits-svc / Bark）        （查看事件日志 / 模拟操作）

                                ↓
                     ┌────────────────────┐
                     │ 机械结构系统（TARS风）│
                     │ • 壳体 + 舵机仓        │
                     │ • OLED窗口 / 开关位    │
                     │ • 电池舱 + 理线卡扣     │
                     └────────────────────┘
```

## 📁 项目结构

```
open-tras/
├── 1.Hardware/          # 硬件设计文件
├── 2.Firmware/          # ESP32-S3 固件代码
├── 3.Software/          # 后端服务代码
├── 4.CAD-Model/         # 3D建模文件
├── 5.Docs/              # 项目文档
└── README.md            # 项目说明
```
